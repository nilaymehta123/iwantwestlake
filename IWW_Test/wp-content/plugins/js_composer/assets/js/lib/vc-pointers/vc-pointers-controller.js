var vcPointersController;!function(t){"use strict";vcPointersController=function(t,i){this.pointers=t&&t.messages||[],this._texts=i,this.pointerId=t&&t.pointer_id?t.pointer_id:"",this.pointerData={},this._index=0,this.messagesDismissed=!1,this.init()},vcPointersController.prototype={init:function(){_.bindAll(this,"show","clickEventClose","clickEventNext","clickEventPrev","buttonsEvent"),this.build()},getPointer:function(t){return this.pointerData=this.pointers[t]&&this.pointers[t].target?this.pointers[t]:null,this.pointerData&&this.pointerData.options?new vcPointerMessage(this.pointerData.target,this.buildOptions(this.pointerData.options),this._texts):null},buildOptions:function(t){return t.buttons=t.buttonsEvent&&_.isFunction(window[t.buttonsEvent])?_.bind(window[t.buttonsEvent],this):this.buttonsEvent,t.vcPointerController=this,t},build:function(){return this.pointer=this.getPointer(this._index),vc.events.once("backendEditor.close",this.close,this),this.pointer?void this.setShowEventHandler():!1},show:function(){this.pointer.show(),this.setCloseEventHandler(),vc.events.trigger("vcPointer:show")},setShowEventHandler:function(){var i;this.pointerData.showCallback&&window[this.pointerData.showCallback]?window[this.pointerData.showCallback].call(this):this.pointerData.showEvent?this.pointerData.showEvent.match(/\s/)?(i=this.pointerData.closeEvent.split(/\s+(.+)?/),1<i.length&&t(i[1]).one(i[0],this.show)):vc.events.once(this.pointerData.showEvent,this.show):this.show()},setCloseEventHandler:function(){var i;this.pointerData.closeCallback&&window[this.pointerData.closeCallback]?window[this.pointerData.closeCallback].call(this):this.pointerData.closeEvent?this.pointerData.closeEvent.match(/\s/)?(i=this.pointerData.closeEvent.split(/\s+(.+)?/),t(i[1]||this.$pointer).one(i[1]&&i[0]?i[0]:"click",this.clickEventNext)):vc.events.once(this.pointerData.closeEvent,this.nextOnEvent,this):this.pointer.$pointer&&0<this.pointer.$pointer.length&&t(this.pointer.$pointer).one("click",this.clickEventNext)},nextOnEvent:function(){this.close(),this.next()},next:function(){this._index++,this.build()},prev:function(){this._index--,this.build()},close:function(){this.pointer&&(this.pointer.close(),this.pointerData=null,this.pointer=null,vc.events.trigger("vcPointer:close",this))},buttonsEvent:function(){var t,i,n,e;return t=this.pointer.domCloseBtn(),i=this.pointer.domNextBtn(),n=this.pointer.domPrevBtn(),t.bind("click.vcPointer",this.clickEventClose),e=this.pointer.domButtonsWrapper().append(t),0<this._index&&(n.bind("click.vcPointer",this.clickEventPrev),e.addClass("vc_wp-pointer-controls-prev").append(n)),this._index+1<this.pointers.length&&(i.bind("click.vcPointer",this.clickEventNext),e.addClass("vc_wp-pointer-controls-next").append(i)),e},clickEventClose:function(){this.close(),this.dismissMessages()},clickEventNext:function(){this.close(),this.next()},clickEventPrev:function(){this.close(),this.prev()},dismissMessages:function(){return this.messagesDismissed?!1:(t.post(window.ajaxurl,{pointer:this.pointerId,action:"dismiss-wp-pointer"}),void(this.messagesDismissed=!0))}}}(window.jQuery);